<uvc-geojson-map
    [geojson]="geojson"
    [showSpinner]="showSpinner"
    (selectLevel)="onLevelChanged($event)"
    (mapClick)="onMapClick($event)"
    (markerClick)="onMarkerClick($event)"
    (mapZoom)="onMapZoom($event)"
    [popupLocation]="lastClickedMarker?.lngLat"
    [selectedLevelId]="selectedLevelId"
    [symbols]="mapSymbols"
    [markers]="mapMarkers"
    symbolImageUrl="assets/logos/UVAngel_Icon_Reversed.png"
    [symbolLayout]="{
      'icon-size': ['interpolate', ['exponential', 2], ['zoom'], 15, 0.01, 25, 2]
    }"
    [showLevelPicker]="false"
    [showNavigationControls]="true"
    [bounds]="focusBounds"
    [popupOffset]="25"
    >
    <div *ngIf="lastClickedMarker" mapPopup>
        <div *ngIf="lastClickedMarker.feature.feature_type === 'anchor'">
            <span class="font-weight-bold">{{featuresWithLocations[lastClickedMarker.feature.id].name}}</span>
            <div>
                <span>Air Quality:</span>
                <span [class.text-danger]="lastClickedMarker.feature.properties.air_quality === 'Bad'">
                    {{lastClickedMarker.feature.properties.air_quality}}
                </span>
            </div>
            <span>
                {{!lastClickedMarker.feature.properties.occupancy ? 'Not Occupied' : 'Occupancy: ' + lastClickedMarker.feature.properties.occupancy}}
            </span>
        </div>
        <div *ngIf="lastClickedMarker.feature.feature_type === 'amenity'">
            <span class="font-weight-bold">{{lastClickedMarker.feature.properties.device_name}}</span>
        </div>
    </div>
</uvc-geojson-map>
<uva-device-panel *ngIf="sidePanelVisibility.device" class="uva-device-panel" [@enterAnimation]></uva-device-panel>
<uva-room-panel *ngIf="sidePanelVisibility.room"  class="uva-room-panel" [@enterAnimation]></uva-room-panel>
<uva-floor-panel *ngIf="sidePanelVisibility.floor" class="uva-floor-panel" [@enterAnimation]></uva-floor-panel>

<!--div class="uva-temp-floating-buttons">
  <button (click)="setSidePanelVisibility('device')">View Device Panel</button>
  <button (click)="setSidePanelVisibility('room')">View Room Panel</button>
  <button (click)="setSidePanelVisibility('floor')">View Floor Panel</button>
</div-->

<uva-enviro-control-panel></uva-enviro-control-panel>
